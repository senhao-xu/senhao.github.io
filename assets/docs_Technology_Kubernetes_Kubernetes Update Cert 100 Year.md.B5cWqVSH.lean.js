import{_ as i,c as a,a2 as h,o as n}from"./chunks/framework.DPuwY6B9.js";const g=JSON.parse('{"title":"Kubernetes Update Cert 100 Year","description":"","frontmatter":{},"headers":[],"relativePath":"docs/Technology/Kubernetes/Kubernetes Update Cert 100 Year.md","filePath":"docs/Technology/Kubernetes/Kubernetes Update Cert 100 Year.md","lastUpdated":1722519091000}'),k={name:"docs/Technology/Kubernetes/Kubernetes Update Cert 100 Year.md"};function t(l,s,p,e,F,r){return n(),a("div",null,s[0]||(s[0]=[h(`<h1 id="kubernetes-update-cert-100-year" tabindex="-1">Kubernetes Update Cert 100 Year <a class="header-anchor" href="#kubernetes-update-cert-100-year" aria-label="Permalink to &quot;Kubernetes Update Cert 100 Year&quot;">​</a></h1><hr><h2 id="kubernetes-update-cert-100-year-1" tabindex="-1">Kubernetes Update Cert 100 Year <a class="header-anchor" href="#kubernetes-update-cert-100-year-1" aria-label="Permalink to &quot;Kubernetes Update Cert 100 Year&quot;">​</a></h2><p>Kubernetes 中大量用到了证书, 比如 ca证书、以及 kubelet、apiserver、proxy、etcd等组件，还有 kubeconfig 文件。</p><p>如果证书过期，轻则无法登录 Kubernetes 集群，重则整个集群异常。</p><p>为了解决证书过期的问题，一般有以下几种方式：</p><p>1.大幅延长证书有效期，短则 10年，长则 100 年；</p><p>2.证书快过期是自动轮换，如 Rancher 的 K3s，RKE2 就采用这种方式；</p><p>3.增加证书过期的监控，便于提早发现证书过期问题并人工介入</p><h3 id="获取源码" tabindex="-1">获取源码 <a class="header-anchor" href="#获取源码" aria-label="Permalink to &quot;获取源码&quot;">​</a></h3><h4 id="通过github" tabindex="-1">通过github <a class="header-anchor" href="#通过github" aria-label="Permalink to &quot;通过github&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#拉取github代码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/kubernetes/kubernetes.git</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#切换到使用的kubernetes版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkout</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remotes/origin/release-1.20</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v1.20.15</span></span></code></pre></div><h4 id="下载源码" tabindex="-1">下载源码 <a class="header-anchor" href="#下载源码" aria-label="Permalink to &quot;下载源码&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/kubernetes/kubernetes/archive/v1.25.5.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -zxvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes-1.25.5.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes-1.25.5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes</span></span></code></pre></div><h3 id="修改证书默认事件" tabindex="-1">修改证书默认事件 <a class="header-anchor" href="#修改证书默认事件" aria-label="Permalink to &quot;修改证书默认事件&quot;">​</a></h3><blockquote><p>vim staging/src/k8s.io/client-go/util/cert/cert.go</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">func</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NewSelfSignedCACert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cfg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Config,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> key</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> crypto.Signer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) (*x509.Certificate, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        now</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time.Now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        tmpl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x509.Certificate{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                SerialNumber:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">big.Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.SetInt64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                Subject:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pkix.Name{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        CommonName:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   cfg.CommonName,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        Organization:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cfg.Organization,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                NotBefore:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             now.UTC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                //NotAfter:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              now.Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">duration365d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.UTC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               #//update cert time.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                NotAfter:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              now.Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">duration365d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.UTC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                KeyUsage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              x509.KeyUsageKeyEncipherment</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> x509.KeyUsageDigitalSignature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> x509.KeyUsageCertSign,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                BasicConstraintsValid:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                IsCA:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                  true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        certDERBytes,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> err</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x509.CreateCertificate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cryptorand.Reader,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tmpl,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tmpl,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> key.Public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> err</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> !=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nil</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nil,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> err</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x509.ParseCertificate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certDERBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><blockquote><p>vim cmd/kubeadm/app/constants/constants.go</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        //</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> KubernetesDir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Kubernetes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> owns</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> storing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> various</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> configuration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> files</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        KubernetesDir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/kubernetes&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        //</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ManifestsSubDirName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> defines</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> store</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> manifests</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        ManifestsSubDirName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;manifests&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        //</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TempDirForKubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> defines</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> temporary</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubeadm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        //</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> should</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> joined</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> KubernetesDir.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        TempDirForKubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;tmp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        //</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CertificateValidity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> defines</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> validity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> signed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certificates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubeadm</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        #// update this CertificateValidity</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        CertificateValidity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time.Hour</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 24</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 365</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        //</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CACertAndKeyBaseName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> defines</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> authority</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> base</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        CACertAndKeyBaseName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ca&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        //</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CACertName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> defines</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        CACertName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ca.crt&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        //</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CAKeyName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> defines</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        CAKeyName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ca.key&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="编译" tabindex="-1">编译 <a class="header-anchor" href="#编译" aria-label="Permalink to &quot;编译&quot;">​</a></h3><h4 id="本机编译" tabindex="-1">本机编译 <a class="header-anchor" href="#本机编译" aria-label="Permalink to &quot;本机编译&quot;">​</a></h4><p>安装依赖</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rsync</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span></code></pre></div><p>安装Golang环境</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#查看需要的goLang版本</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@master kubernetes]# cat ./build/build-image/cross/VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">v1.25.0-go1.19.4-bullseye.0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#下载</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://dl.google.com/go/go1.19.4.linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#解压到指定目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zxvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> go1.19.4.linux-amd64.tar.gz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#临时生效</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PATH:/usr/local/go/bin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#查看</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span></span></code></pre></div><p>编译</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> WHAT=cmd/kubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GOFLAGS=-v</span></span></code></pre></div><h3 id="更新kubeadm" tabindex="-1">更新kubeadm <a class="header-anchor" href="#更新kubeadm" aria-label="Permalink to &quot;更新kubeadm&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/bin/kubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/bin/kubeadm_backup</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> _output/local/bin/linux/amd64/kubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/bin/kubeadm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/bin/kubeadm</span></span></code></pre></div><h3 id="续订证书" tabindex="-1">续订证书 <a class="header-anchor" href="#续订证书" aria-label="Permalink to &quot;续订证书&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@master kubernetes]# kubeadm certs renew all</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[renew] Reading configuration from the cluster...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[renew] FYI: You can look at this config file with </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> embedded</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubeconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> itself</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> serving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Kubernetes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> API</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apiserver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uses</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> access</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> etcd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> API</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> connect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubelet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> embedded</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubeconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> controller</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> manager</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> liveness</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> probes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> healthcheck</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> etcd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> etcd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nodes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> communicate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> each</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> other</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> serving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> etcd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> front</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> proxy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> client</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> embedded</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubeconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scheduler</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> manager</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewed</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Done</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renewing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certificates.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> must</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kube-apiserver,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kube-controller-manager,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kube-scheduler</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> etcd,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> so</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> they</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certificates.</span></span></code></pre></div><h3 id="查看证书时间" tabindex="-1">查看证书时间 <a class="header-anchor" href="#查看证书时间" aria-label="Permalink to &quot;查看证书时间&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@master kubernetes]# kubeadm certs check-expiration</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[check-expiration] Reading configuration from the cluster...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[check-expiration] FYI: You can look at this config file with </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CERTIFICATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                EXPIRES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  RESIDUAL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TIME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   CERTIFICATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AUTHORITY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   EXTERNALLY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MANAGED</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">admin.conf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apiserver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apiserver-etcd-client</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             etcd-ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apiserver-kubelet-client</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">controller-manager.conf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">etcd-healthcheck-client</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             etcd-ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">etcd-peer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             etcd-ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">etcd-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             etcd-ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">front-proxy-client</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             front-proxy-ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scheduler.conf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2122</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   99y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CERTIFICATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AUTHORITY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   EXPIRES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  RESIDUAL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TIME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   EXTERNALLY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MANAGED</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 03,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2032</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 07:37</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   9y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">etcd-ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 03,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2032</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 07:37</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   9y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">front-proxy-ca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          Nov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 03,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2032</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 07:37</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UTC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   9y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              no</span></span></code></pre></div><h3 id="注意" tabindex="-1">注意 <a class="header-anchor" href="#注意" aria-label="Permalink to &quot;注意&quot;">​</a></h3><p>正常执行完成过后，出现etcd证书9y的情况，需要在初始化是使用编译后的<code>kubeadm</code></p>`,35)]))}const y=i(k,[["render",t]]);export{g as __pageData,y as default};
