import{_ as s,c as i,a2 as a,o as e}from"./chunks/framework.DPuwY6B9.js";const k=JSON.parse('{"title":"Containerd","description":"","frontmatter":{},"headers":[],"relativePath":"docs/Technology/Tomato/Containerd.md","filePath":"docs/Technology/Tomato/Containerd.md","lastUpdated":1722519091000}'),d={name:"docs/Technology/Tomato/Containerd.md"};function n(l,t,r,h,p,c){return e(),i("div",null,t[0]||(t[0]=[a(`<h1 id="containerd" tabindex="-1">Containerd <a class="header-anchor" href="#containerd" aria-label="Permalink to &quot;Containerd&quot;">​</a></h1><h2 id="containerd常用操作" tabindex="-1">Containerd常用操作 <a class="header-anchor" href="#containerd常用操作" aria-label="Permalink to &quot;Containerd常用操作&quot;">​</a></h2><p><strong>containerd Version : 1.6.22</strong></p><p><code>ctr</code> 是 <code>containerd</code> 的一个客户端工具。</p><h3 id="镜像" tabindex="-1">镜像 <a class="header-anchor" href="#镜像" aria-label="Permalink to &quot;镜像&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Containerd命令</th><th>示例</th><th>说明</th></tr></thead><tbody><tr><td>ctr image ls</td><td>ctr -n k8s.io i ls</td><td>查看本地镜像</td></tr><tr><td>ctr image pull</td><td>ctr image pull docker.io/library/nginx:alpine</td><td>拉取镜像</td></tr><tr><td>ctr image push</td><td>ctr -n=k8s.io image push --user admin:Harbor12345 10.0.0.4/test/nginx</td><td>推送镜像</td></tr><tr><td>ctr image import</td><td>ctr -n default image import pg_dump.tar - docker.v1.1</td><td>导入镜像</td></tr><tr><td>ctr image export</td><td>ctr -n default image export coredns.tar coredns:1.2.0</td><td>导出镜像</td></tr><tr><td>ctr image tag</td><td>ctr -n=default image tag docker.io/library/nginx:1.18.0 10.0.0.5:1180/test/nginx:1.18.0</td><td>打镜像标签</td></tr><tr><td>ctr image rm</td><td>ctr -n=default image rm docker.io/rancher/pause:3.1</td><td>删除镜像</td></tr><tr><td>ctr namespaces ls</td><td>ctr namespaces ls</td><td>查看命名空间</td></tr><tr><td>ctr task ls</td><td>ctr task ls</td><td>查看运行的容器</td></tr></tbody></table><table tabindex="0"><thead><tr><th>Containerd命令</th><th>Docker命令</th><th>描述</th></tr></thead><tbody><tr><td>ctr task ls</td><td>docker ps</td><td>查看运行容器</td></tr><tr><td>ctr image ls</td><td>docker images</td><td>获取image信息</td></tr><tr><td>ctr image pull pause</td><td>docker pull pause</td><td>pull 应该pause镜像</td></tr><tr><td>ctr image push pause-test</td><td>docker push pause-test</td><td>改名</td></tr><tr><td>ctr image import pause.tar</td><td>docker load 镜像</td><td>导入本地镜像</td></tr><tr><td>ctr run -d pause-test pause</td><td>docker run -d --name=pause pause-test</td><td>运行容器</td></tr><tr><td>ctr image tag pause pause-test</td><td>docker tag pause pause-test</td><td>tag应该pause镜像</td></tr></tbody></table><blockquote><p>查看镜像</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n=k8s.io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span></span></code></pre></div><blockquote><p>拉取镜像</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n=default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --all-platforms</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker.io/library/nginx:1.18.0</span></span></code></pre></div><blockquote><p>导出镜像</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> k8s.io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> export</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> k8s_1.26.1.tar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.aliyuncs.com/google_containers/kube-apiserver:v1.26.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.aliyuncs.com/google_containers/kube-controller-manager:v1.26.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.aliyuncs.com/google_containers/kube-scheduler:v1.26.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.aliyuncs.com/google_containers/kube-proxy:v1.26.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.aliyuncs.com/google_containers/pause:3.9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.aliyuncs.com/google_containers/etcd:3.5.6-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.aliyuncs.com/google_containers/coredns:v1.9.3</span></span></code></pre></div><blockquote><p>导入镜像</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> k8s.io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> images/k8s_1.26.1.tar</span></span></code></pre></div><blockquote><p>删除镜像</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n=default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker.io/library/nginx:1.18.0</span></span></code></pre></div><blockquote><p>标签</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n=default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tag</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker.io/library/nginx:1.18.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.0.0.5:1180/test/nginx:1.18.0</span></span></code></pre></div><h3 id="容器" tabindex="-1">容器 <a class="header-anchor" href="#容器" aria-label="Permalink to &quot;容器&quot;">​</a></h3><blockquote><p>查看容器</p></blockquote><p><strong>list</strong> 可以简写为<code>ls</code></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> k8s.io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> container</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ls</span></span></code></pre></div><blockquote><p>查看容器信息</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> k8s.io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> container</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx</span></span></code></pre></div><blockquote><p>查看任务</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> k8s.io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> task</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ls</span></span></code></pre></div><blockquote><p>进入容器</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ctr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> task</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --exec-id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sh</span></span></code></pre></div><h2 id="crictl命令" tabindex="-1">crictl命令 <a class="header-anchor" href="#crictl命令" aria-label="Permalink to &quot;crictl命令&quot;">​</a></h2><table tabindex="0"><thead><tr><th>crictl</th><th>docker</th><th>注解</th><th>其他</th></tr></thead><tbody><tr><td>crictl pull</td><td>docker pull</td><td>拉取镜像</td><td></td></tr><tr><td>crictl images</td><td>docker images</td><td>查看镜像</td><td>crictl images -q 只打印镜像id</td></tr><tr><td>crictl inspecti</td><td>docker inspect</td><td>查看镜像详情</td><td></td></tr><tr><td>crictl rmi</td><td>docker rmi</td><td>删除镜像</td><td></td></tr><tr><td>--</td><td>docker push</td><td>推送镜像</td><td>可使用ctr image push</td></tr><tr><td>--</td><td>docker load/save -i</td><td>导入/导出镜像</td><td>可使用ctr images import/export</td></tr><tr><td>crictl ps</td><td>docker ps</td><td>查看容器</td><td></td></tr><tr><td>crictl inspect</td><td>docker inspect</td><td>查看容器详情</td><td></td></tr><tr><td>crictl logs</td><td>docker logs</td><td>查看容器日志</td><td></td></tr><tr><td>crictl exec</td><td>docker exec</td><td>容器内执行命令</td><td></td></tr><tr><td>crictl stats</td><td>docker stats</td><td>查看容器资源使用情况</td><td></td></tr><tr><td>crictl create</td><td>docker create</td><td>创建容器</td><td></td></tr><tr><td>crictl start/stop</td><td>docker start/stop</td><td>启动/停止容器</td><td></td></tr><tr><td>crictl rm</td><td>docker rm</td><td>删除容器</td><td></td></tr><tr><td>crictl pods</td><td>--</td><td>查看Pod列表</td><td></td></tr><tr><td>crictl inspectp</td><td>--</td><td>查看Pod详情</td><td></td></tr><tr><td>crictl runp</td><td>--</td><td>启动Pod</td><td></td></tr><tr><td>crictl stopp</td><td>--</td><td>停止Pod</td><td></td></tr></tbody></table><h3 id="crictl-配置" tabindex="-1">crictl 配置 <a class="header-anchor" href="#crictl-配置" aria-label="Permalink to &quot;crictl 配置&quot;">​</a></h3><ul><li><code>crictl</code> 是遵循 CRI 接口规范的一个命令行工具，通常用它来检查和管理<code>kubelet</code>节点上的容器运行时和镜像。</li></ul><blockquote><p>通过配置文件</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 通过在配置文件中设置端点 --config=/etc/crictl.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@k8s-node-0001:~$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/crictl.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">runtime-endpoint:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unix:///run/containerd/containerd.sock</span></span></code></pre></div><blockquote><p>通过命令</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crictl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> runtime-endpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unix:///run/containerd/containerd.sock</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crictl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image-endpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unix:///run/containerd/containerd.sock</span></span></code></pre></div><p>‍</p>`,38)]))}const g=s(d,[["render",n]]);export{k as __pageData,g as default};
